# 7.4 Test Each Merge Strategy Option

## Test Environment
Fresh test repo at `/tmp/git-merge-test` with multiple plan branches to test each strategy.

## Test 1: `--merge squash` (Default)

### Setup
- Plan branch: `plan/test-squash`
- 3 individual task commits

### Execution
```bash
git merge --squash plan/test-squash
git commit -m "Complete: test-squash (squash merge test)"
```

### Result
Master history:
```
fdb4560 Complete: test-squash (squash merge test)
32e61a7 Initial commit
```

**✓ PASS** - Single squashed commit contains all changes from 3 task commits.

---

## Test 2: `--merge commit` (Merge Commit, Preserves History)

### Setup
- Plan branch: `plan/test-merge-commit`
- 2 individual task commits

### Execution
```bash
git merge --no-ff plan/test-merge-commit -m "Merge message"
```

### Result
Master history with graph:
```
*   271e2ce Merge branch 'plan/test-merge-commit' (--merge commit test)
|\
| * 7bb9bec [test-merge-commit] task 2.2: Create feature2
| * 2f248aa [test-merge-commit] task 2.1: Create feature1
|/
* fdb4560 Complete: test-squash (squash merge test)
```

**✓ PASS** - Merge commit created with two-parent history. Individual commits visible in main history.

---

## Test 3: `--merge ff` (Fast-Forward)

### Setup
- Plan branch: `plan/test-ff` created from current master
- 2 individual task commits
- No divergence from master

### Execution
```bash
git merge --ff-only plan/test-ff
```

### Result
```
Master HEAD before FF: 271e2ce
Master HEAD after FF: bd489bc

bd489bc [test-ff] task 3.2: Create ff-file2
8e73511 [test-ff] task 3.1: Create ff-file1
```

**✓ PASS** - HEAD moved forward. No merge commit created. Individual commits appear directly in main history.

---

## Test 4: `--merge ff` Failure Case (Divergence)

### Setup
- Plan branch: `plan/test-ff-fail` with 1 commit
- Master has additional commit after plan branch creation (divergence)

### Execution
```bash
git merge --ff-only plan/test-ff-fail
```

### Result
```
fatal: Not possible to fast-forward, aborting.
```

**✓ PASS** - FF merge correctly rejected when divergence exists. Clear error message with alternatives (--no-ff or rebase).

---

## Summary

| Strategy | Behavior | Use Case | Test Result |
|----------|----------|----------|-------------|
| `--merge squash` | Single new commit | Clean main history (default) | ✓ PASS |
| `--merge commit` | Merge commit + individual | Preserve merge point, bisect history | ✓ PASS |
| `--merge ff` | Move HEAD forward | Linear history, no divergence | ✓ PASS |
| `--merge ff` (fail) | Abort on divergence | Requires rebase or alternate strategy | ✓ PASS |

## History Comparison After Tests

```
Master log:
57c7c8b Master: add change
bd489bc [test-ff] task 3.2: Create ff-file2
8e73511 [test-ff] task 3.1: Create ff-file1
271e2ce Merge branch 'plan/test-merge-commit' (--merge commit test)
7bb9bec [test-merge-commit] task 2.2: Create feature2
2f248aa [test-merge-commit] task 2.1: Create feature1
fdb4560 Complete: test-squash (squash merge test)
32e61a7 Initial commit
```

- **Squash**: Single "Complete:" commit (fdb4560)
- **Commit**: Merge commit with visible branch history (271e2ce + children)
- **FF**: Individual commits directly on master (bd489bc, 8e73511)

## Result: PASS

All three merge strategies work correctly:
1. ✓ `--merge squash` creates single commit
2. ✓ `--merge commit` creates merge commit preserving history
3. ✓ `--merge ff` fast-forwards when possible
4. ✓ `--merge ff` fails gracefully on divergence
