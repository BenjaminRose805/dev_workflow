# 3.3 Task Standards Analysis

**Status:** completed
**Started:** 2025-12-25
**Summary:** Mapped all documents defining task standards, identified the authoritative sources, documented current standards, and found 10 gaps and 2 conflicts.

---

## Documents Defining Task Standards

### Plan Status Schema (PRIMARY AUTHORITY for execution state)
- **Path**: `scripts/lib/schemas/plan-status.json`
- **Purpose**: JSON Schema defining the canonical structure for task tracking in status.json files
- **Task requirements defined**:
  - Task ID format: `N.N` or `N.N.N` format with pattern `^\d+\.\d+(\.\d+)?$`
  - Task status enum: "pending", "in_progress", "completed", "failed", "skipped"
  - Required task fields: id, description, status
  - Optional task fields: phase, startedAt, completedAt, duration, findingsPath, error, notes, skipReason
  - Summary counts: totalTasks, completed, pending, failed, skipped, in_progress

### Implementation Plan Standards (PRIMARY AUTHORITY for plan structure)
- **Path**: `docs/standards/implementation-plan-standards.md`
- **Purpose**: Authoritative standards document for all implementation plans defining task structure, naming conventions, quality targets, and plan structure
- **Task requirements defined**:
  - Phase and task numbering format (N.1, N.2, N.N.N for subtasks)
  - Required sections for plans
  - Verification criteria format
  - Output directory structure with findings location
  - Task ID format conventions
  - Finding file naming conventions

### Plan Template Format Documentation
- **Path**: `docs/plan-templates/TEMPLATE.md`
- **Purpose**: Documents template conventions for creating plans
- **Task requirements defined**:
  - Checkbox format: `- [ ]` for incomplete, `- [x]` for complete
  - Task ID format: N.1, N.2, N.3 for tasks; N.M.1, N.M.2 for subtasks
  - Verification section: `**VERIFY Phase N:**` with checkbox items

### Findings Format Specification
- **Path**: `docs/plan-outputs/FINDINGS-FORMAT.md`
- **Purpose**: Defines standard format for task findings output files
- **Task requirements defined**:
  - Finding file naming: `{task-id}.md` with dots replaced by hyphens (1.1 → 1-1.md)
  - Required sections: Status, Started, Completed, Duration, Summary
  - Optional sections: Details, Files Modified, Code Changes, Analysis, Recommendations, Errors, Related Tasks

### Architecture Documentation
- **Path**: `docs/ARCHITECTURE.md`
- **Purpose**: System architecture document describing task tracking system
- **Task requirements defined**:
  - Task state values: pending, in_progress, completed, failed, skipped
  - Status.json is the authoritative source of truth for task state

### Canonical Command Template
- **Path**: `docs/plan-templates/CANONICAL-COMMAND-TEMPLATE.md`
- **Purpose**: Template for implementation plan commands
- **Task requirements defined**:
  - Phase structure with objective, tasks, and VERIFY sections
  - Task numbering convention starting at phase level

---

## Authoritative Source Analysis

### Primary Authority: `scripts/lib/schemas/plan-status.json`

This is the true authoritative document for task structure because:
1. It defines the JSON Schema that is programmatically validated by the system
2. The file explicitly states: "This is the canonical schema for status.json files"
3. It specifies exact validation rules (regex patterns, enums, required fields)
4. The ARCHITECTURE.md document confirms: "status.json is the authoritative source of truth for execution state"

### Secondary Authority: `docs/standards/implementation-plan-standards.md`

This is the authoritative document for plan-level structure and conventions because:
1. It declares itself as "the authoritative standards for all implementation plans"
2. It covers naming conventions, phase structure, and task organization
3. It provides context and rationale for standards
4. It documents output directory conventions

### Supporting Documents:
- `FINDINGS-FORMAT.md` - Defines task findings output format
- `TIMESTAMPS-FORMAT.md` - Defines task timing data format
- `ARCHITECTURE.md` - Describes system design and task state values

---

## Current Task Standards (as documented)

### Required Elements

**For Each Task in status.json:**
| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `id` | string | ✓ | Task identifier in N.N or N.N.N format |
| `description` | string | ✓ | Task description from plan |
| `status` | string enum | ✓ | One of: pending, in_progress, completed, failed, skipped |
| `phase` | string | Optional | Phase this task belongs to |

**For Completed Tasks (recommended):**
| Field | Type | Description |
|-------|------|-------------|
| `startedAt` | ISO-8601 | When task execution started |
| `completedAt` | ISO-8601 | When task execution completed |
| `duration` | number (ms) | Execution duration in milliseconds |
| `findingsPath` | string | Relative path to findings markdown file |
| `notes` | string | Notes about completion or implementation details |

**For Failed Tasks:**
| Field | Type | Description |
|-------|------|-------------|
| `error` | string | Error message explaining failure |

**For Skipped Tasks:**
| Field | Type | Description |
|-------|------|-------------|
| `skipReason` | string | Reason for skipping the task |

### ID Format Conventions

**Basic Format:**
- **Basic tasks**: `N.N` format (e.g., 1.1, 2.3, 3.5)
- **Subtasks**: `N.N.N` format (e.g., 1.2.1, 2.3.2)
- **Verification tasks**: VERIFY prefix with phase number (e.g., "VERIFY 1", "VERIFY Phase 1")
- **Regex pattern validation**: `^\d+\.\d+(\.\d+)?$` (must match this pattern)

**File Naming:**
- Finding file naming: Task IDs with dots replaced by hyphens (1.1 → `1-1.md`, 2.3.2 → `2-3-2.md`)

**Conventions from Implementation Plan Standards:**
- Phase numbering: 0, 1, 2, 3... (Phase 0 for prerequisites)
- Numbering rules:
  - Phases: 0, 1, 2, 3...
  - Tasks: N.1, N.2, N.3...
  - Subtasks: N.M.1, N.M.2, N.M.3...

### Status States

**Five Valid States:**

| State | Description |
|-------|-------------|
| `pending` | Task not yet started |
| `in_progress` | Task currently being worked on |
| `completed` | Task finished successfully |
| `failed` | Task execution failed with error |
| `skipped` | Task deliberately skipped with documented reason |

**State Transitions (implied from architecture):**
```
pending → in_progress (when task starts)
in_progress → completed (when task finishes successfully)
in_progress → failed (when task encounters error)
pending/in_progress → skipped (when task is deliberately bypassed)
```

### Checklist Format

**Markdown Plan Format (from TEMPLATE.md):**
```markdown
- [ ] Task number Task description
- [ ] 1.1 First task
- [ ] 1.2 Second task
  - [ ] 1.2.1 Subtask of 1.2
  - [ ] 1.2.2 Another subtask

**VERIFY Phase 1:**
- [ ] Verification criterion
- [ ] Another criterion
```

**Status Tracking Location:**
- Checkboxes in markdown files are **read-only reference documentation**
- **Actual task state is stored exclusively in `status.json`** (not checkboxes)
- The checkbox format is purely for human readability of the plan structure

### Other Requirements

**Finding Files Format (from FINDINGS-FORMAT.md):**
- Required sections: Status, Started, Completed, Duration, Summary, Details
- Optional sections: Files Modified, Code Changes, Analysis, Recommendations, Errors, Related Tasks
- Status field values in findings: "completed | failed | skipped"
- ISO-8601 timestamp format for timestamps
- Duration formatted as human-readable string (e.g., "5m", "30s")

**Output Directory Structure:**
```
docs/plan-outputs/{plan-name}/
├── artifacts/           # Generated artifacts
│   ├── {artifact-type}.json
│   └── {artifact-type}.md
├── findings/            # Task findings and analysis
│   ├── {task-id}.md
│   └── {task-id}-{description}.md
├── verification/        # Verification results
│   └── phase-{n}-results.md
└── status.json          # Task status tracking (AUTHORITATIVE)
```

**Timing Data (from TIMESTAMPS-FORMAT.md):**
- Optional: `timestamps/` subdirectory for detailed timing
- Per-task timing tracked separately from status.json
- File naming: `timestamps/tasks/{task-id}.json` (dots replaced by hyphens)

---

## Gaps Identified

### 1. TodoWrite Task Format Not Documented
**Gap**: The TodoWrite tool used in the conversation system (with `content`, `activeForm`, `status` fields) is not documented in any standards or schema files
**Impact**: No formal specification exists for real-time conversation task tracking separate from plan tasks

### 2. Task Dependencies Not Standardized
**Gap**: No documented standard for expressing dependencies between tasks (e.g., task 2.1 depends on task 1.3)
**Impact**: Complex plans with interdependencies have no formal way to express relationships

### 3. Parallel Task Execution Not Specified
**Gap**: No standard for marking tasks that can execute in parallel
**Impact**: Execution order and parallelization strategy unclear from standards alone

### 4. Task Complexity/Effort Estimation Missing
**Gap**: No documented standard for estimating task difficulty, time, or resource requirements
**Impact**: Plans provide no guidance on expected duration or complexity level

### 5. Task Categories Not Formalized
**Gap**: No taxonomy of task categories (implementation, verification, research, etc.)
**Impact**: Difficult to distinguish task types programmatically

### 6. Run/Batch Tracking Minimally Specified
**Gap**: `runs` array in status.json exists but is largely undocumented
**Impact**: Run history tracking has minimal specification of what should be recorded

### 7. Sub-Task Hierarchy Depth Not Limited
**Gap**: Pattern allows `N.N.N` but no specification of maximum nesting depth
**Impact**: Unclear if deeper nesting (N.N.N.N) is permitted or encouraged

### 8. Subtask Relationship to Parent Not Specified
**Gap**: No documented standard for defining subtask relationship to parent beyond naming
**Impact**: Tooling must infer parent-child relationships from ID parsing alone

### 9. Task Reusability/Templating Not Covered
**Gap**: No standard for templated or repeated task patterns
**Impact**: Duplicate task logic cannot be formally represented

### 10. Concurrent Task Conflict Prevention Not Documented
**Gap**: No standard for preventing conflicting concurrent modifications
**Impact**: Unclear how system handles simultaneous task updates

---

## Conflicts Found

### 1. Task State in Markdown vs. status.json

**Conflict Details:**
- TEMPLATE.md shows checkbox format: `- [ ] Task` and `- [x] Task`
- ARCHITECTURE.md explicitly states: "The markdown plan file is **read-only** during execution"
- implementation-plan-standards.md shows checkboxes in Phase structure
- PLAN-EXECUTION clarifies: "All task state lives in `status.json`" not checkboxes

**Resolution:** The standard clearly prioritizes status.json as authoritative, but plan documentation shows checkbox format. This could confuse users expecting checkboxes to track state.

**Recommendation:** Clearly document that checkboxes are for human reference only during planning; execution tracking uses status.json exclusively.

### 2. Finding File Format Naming

**Conflict Details:**
- implementation-plan-standards.md example shows: `{task-id}-{description}.md`
- FINDINGS-FORMAT.md specifies: `{task-id}.md` with optional {description} separated
- Actual files use both patterns (e.g., `1-1.md` and `1.1-analysis-results.md`)

**Resolution:** FINDINGS-FORMAT.md is more specific and prescriptive. The standards document shows it as an option.

**Recommendation:** Clarify that base file is `{task-id}.md` and adding description suffix is optional but recommended.

---

## Summary Table

| Category | Status | Details |
|----------|--------|---------|
| **Authoritative Source (Execution)** | ✓ Clear | `scripts/lib/schemas/plan-status.json` (JSON Schema) |
| **Authoritative Source (Structure)** | ✓ Clear | `docs/standards/implementation-plan-standards.md` |
| **Required Fields** | ✓ Well-Defined | id, description, status |
| **ID Format** | ✓ Well-Defined | N.N or N.N.N with regex validation |
| **Status States** | ✓ Well-Defined | 5 states: pending, in_progress, completed, failed, skipped |
| **Checklist Format** | ✓ Well-Defined | `- [ ]` / `- [x]` checkbox format |
| **Findings Format** | ✓ Well-Defined | Documented in FINDINGS-FORMAT.md |
| **Task Dependencies** | ⚠ Gap | Not standardized |
| **Parallel Execution** | ⚠ Gap | Not specified |
| **Task Complexity** | ⚠ Gap | No estimation standards |
| **Task Categories** | ⚠ Gap | No formal taxonomy |
| **Subtask Depth** | ⚠ Gap | No limit specified |
| **Concurrent Updates** | ⚠ Gap | Not documented |
