# Task 0.2: Import Analysis for Each Component

## Summary

Analyzed `scripts/plan_orchestrator.py` (1423 lines) to identify imports needed by each component targeted for extraction.

## Component Import Requirements

### 1. TUI Module (`scripts/lib/tui.py`)

**Components:** Activity, ActivityTracker, RichTUIManager

**Required Imports:**
```python
# Standard library
import threading
import time
from collections import deque
from dataclasses import dataclass, field
from datetime import datetime
from typing import Callable, Dict, List, Optional

# Rich library (with try/except for fallback)
try:
    from rich.console import Console
    from rich.layout import Layout
    from rich.live import Live
    from rich.panel import Panel
    from rich.table import Table
    from rich.text import Text
    RICH_AVAILABLE = True
except ImportError:
    RICH_AVAILABLE = False
```

**Notes:**
- `Activity` uses: `dataclass`, `datetime`, `Dict`, `Optional`
- `ActivityTracker` uses: `deque`, `threading.Lock`, `Dict`, `List`, `Activity`
- `RichTUIManager` uses: all Rich imports, `threading.Lock`, `time`, `Dict`, `List`, `Optional`, `ActivityTracker`

---

### 2. Claude Runner Module (`scripts/lib/claude_runner.py`)

**Components:** StreamingClaudeRunner

**Required Imports:**
```python
# Standard library
import json
import subprocess
import time
from typing import Callable, Dict, List, Optional, Tuple
```

**Notes:**
- Parses JSON streaming output from Claude CLI
- Manages subprocess for Claude invocation
- Uses callbacks for tool events (start/end/text)
- Does NOT require Rich library

---

### 3. Status Monitor Module (`scripts/lib/status_monitor.py`)

**Components:** StatusMonitor

**Required Imports:**
```python
# Standard library
import json
import os
import threading
from typing import Callable, Dict, Optional

# Optional inotify for Linux (with try/except)
try:
    import inotify.adapters
    import inotify.constants
except ImportError:
    pass  # Fall back to polling
```

**Notes:**
- Monitors `status.json` file for changes
- Uses inotify on Linux for responsive updates, falls back to polling
- Background thread with stop event pattern

---

### 4. Main Orchestrator (`scripts/plan_orchestrator.py` - remaining)

**Components:** PlanStatus, PlanOrchestrator, main()

**Required Imports:**
```python
# Standard library
import argparse
import json
import logging
import os
import subprocess
import sys
import time
from pathlib import Path
from typing import Dict, List, Optional

# Import from new modules
from scripts.lib.tui import Activity, ActivityTracker, RichTUIManager, RICH_AVAILABLE
from scripts.lib.claude_runner import StreamingClaudeRunner
from scripts.lib.status_monitor import StatusMonitor
```

**Notes:**
- Will need conditional Rich import check (use `RICH_AVAILABLE` from tui module)
- Constants like `DEFAULT_MAX_ITERATIONS`, `DEFAULT_TIMEOUT`, etc. stay here
- `STATUS_CLI_JS` path constant stays here

---

## Cross-Module Dependencies

```
plan_orchestrator.py
    ├── imports from tui.py
    │       ├── Activity
    │       ├── ActivityTracker
    │       ├── RichTUIManager
    │       └── RICH_AVAILABLE
    ├── imports from claude_runner.py
    │       └── StreamingClaudeRunner
    └── imports from status_monitor.py
            └── StatusMonitor

tui.py (standalone, no internal imports)

claude_runner.py (standalone, no internal imports)

status_monitor.py (standalone, no internal imports)
```

## Constants Placement

| Constant | Stay in orchestrator | Move to module |
|----------|---------------------|----------------|
| `DEFAULT_MAX_ITERATIONS` | ✓ | - |
| `DEFAULT_TIMEOUT` | ✓ | - |
| `DEFAULT_BATCH_SIZE` | ✓ | - |
| `STATUS_CLI_JS` | ✓ | - |
| `STATUS_CHECK_INTERVAL` | ✓ | - |
| `RICH_AVAILABLE` | - | tui.py |

## Verification Notes

- No circular imports expected (new modules don't import from each other)
- All new modules are standalone with only standard library + optional dependencies
- Main orchestrator imports from new modules, not vice versa
