# Task 5.2: TUI Files/Modules That Can Be Removed

## Overview

This document identifies all TUI-specific files and modules, categorizing each based on whether they can be safely removed in a dashboard-only migration.

## TUI Module Directory: `scripts/tui/`

The entire `scripts/tui/` directory (11 files, ~7,100 LOC) contains TUI-only components.

### File-by-File Analysis

| File | LOC | Status | Rationale |
|------|-----|--------|-----------|
| `__init__.py` | 82 | **SAFE TO REMOVE** | Package exports for TUI components only |
| `panels.py` | 2,302 | **SAFE TO REMOVE** | Display panels (Phase, Upcoming, Run History, Dependency Graph, Subtask Tree, Artifact Browser, Agent Tracker) - Rich-based terminal rendering only |
| `command_runner.py` | 771 | **SAFE TO REMOVE** | TUI command execution with streaming - uses `claude_runner.py` but dashboard has API alternatives |
| `keyboard.py` | 640 | **SAFE TO REMOVE** | Non-blocking terminal input, vim-style navigation, mode switching - no dashboard equivalent needed |
| `error_handler.py` | 536 | **SAFE TO REMOVE** | TUI-specific error recovery and notification - dashboard has React error boundaries |
| `overlays.py` | 525 | **SAFE TO REMOVE** | Modal overlay system (Help, Command Palette, Task Picker, Findings) - terminal modals only |
| `findings_browser.py` | 497 | **SAFE TO REMOVE** | Terminal-based findings file browser - dashboard has FindingsViewer component |
| `task_picker.py` | 484 | **SAFE TO REMOVE** | Interactive task selection modal - dashboard has task list with selection |
| `command_palette.py` | 464 | **SAFE TO REMOVE** | VS Code-style command discovery UI - terminal only |
| `task_actions.py` | 428 | **SAFE TO REMOVE** | Keyboard action handlers (e/i/v/s/f/d keys) - terminal shortcuts |
| `config.py` | 371 | **SAFE TO REMOVE** | TUI configuration persistence (`~/.config/claude-code/tui-panels.json`) - terminal-specific settings |

**Total: 7,100 LOC - All SAFE TO REMOVE**

## Related File: `scripts/lib/tui.py`

| File | LOC | Status | Rationale |
|------|-----|--------|-----------|
| `lib/tui.py` | 2,425 | **REVIEW NEEDED** | RichTUIManager and ActivityTracker used by `plan_orchestrator.py` |

### Detailed Analysis of `scripts/lib/tui.py`

This file is more complex because:

1. **Used by `plan_orchestrator.py`**: The orchestrator imports `RichTUIManager` and `RICH_AVAILABLE`
2. **Contains ActivityTracker**: General-purpose activity tracking that could be useful
3. **Optionally imports from `scripts/tui/`**: Imports components like `KeyboardHandler`, `ConfigManager`, panels, etc. as optional dependencies

**Recommendation**:
- If orchestrator runs headless (API-only mode), the Rich TUI is not needed
- `RichTUIManager` is only used for terminal display
- `--no-tui` flag already exists to disable it
- **Can be marked as SAFE TO REMOVE if orchestrator is refactored to not use TUI**

## Dependencies Between TUI and Shared Code

### TUI Dependencies on Shared Libraries

| TUI Component | Depends On | Shared? |
|---------------|------------|---------|
| `command_runner.py` | `scripts/lib/claude_runner.py` | **YES** - Keep `claude_runner.py` |
| `config.py` | Standard library only | No external deps |
| `error_handler.py` | `scripts/tui/config.py` | TUI-only circular |
| All panels | Rich library | External package |

### What TUI Imports from Shared Code

```python
# command_runner.py imports:
from scripts.lib.claude_runner import StreamingClaudeRunner  # KEEP - used by orchestrator

# config.py imports:
# Standard library only - no shared deps
```

### What Shared Code Imports from TUI

```python
# scripts/lib/tui.py imports (optional):
from scripts.tui.config import ConfigManager, TUIConfig
from scripts.tui.keyboard import InputMode, KeyboardHandler
from scripts.tui.panels import (various panels)
from scripts.tui.task_actions import TaskActionHandler
from scripts.tui.error_handler import ErrorHandler
from scripts.tui.overlays import OverlayManager
```

**All TUI imports in `lib/tui.py` are wrapped in try/except blocks**, making them truly optional.

## Summary: Files That Can Be Removed

### Immediately Removable (No Dependencies)

```
scripts/tui/                     # Entire directory (7,100 LOC)
├── __init__.py
├── panels.py
├── keyboard.py
├── command_palette.py
├── task_picker.py
├── task_actions.py
├── command_runner.py
├── overlays.py
├── findings_browser.py
├── error_handler.py
└── config.py
```

### Conditionally Removable (Requires Orchestrator Change)

```
scripts/lib/tui.py               # 2,425 LOC - REVIEW NEEDED
```

**Condition**: Remove if orchestrator is updated to:
1. Always run in API-only mode (no terminal display)
2. Use a simpler progress reporting mechanism
3. Remove the Rich-based TUI entirely from orchestrator

## Removal Impact Assessment

### If `scripts/tui/` is Removed

| Impact Area | Effect |
|-------------|--------|
| Terminal monitoring | Lost - use dashboard instead |
| Vim-style navigation | Lost - not needed in web UI |
| Command palette | Lost - not needed (API commands) |
| Keyboard shortcuts | Lost - web UI has own shortcuts |
| Configuration persistence | Lost - web UI uses different settings |
| Error recovery UI | Lost - dashboard has error handling |

**No dashboard functionality affected.**

### If `scripts/lib/tui.py` is Also Removed

| Impact Area | Effect |
|-------------|--------|
| `plan_orchestrator.py` | Requires refactoring |
| Activity tracking | Needs alternative (API events exist) |
| Terminal progress display | Lost (replaced by API/WebSocket) |

## Recommended Removal Order

1. **Phase 1**: Remove `scripts/tui/` directory (7,100 LOC)
   - No dependencies from dashboard or API server
   - Immediately safe to delete

2. **Phase 2**: Refactor `scripts/lib/tui.py` (2,425 LOC)
   - Extract any useful ActivityTracker logic to API layer
   - Update `plan_orchestrator.py` to work without Rich TUI
   - Remove file after orchestrator is refactored

3. **Phase 3**: Remove `--no-tui` flag and related code
   - Clean up command-line argument handling
   - Remove conditional TUI logic from orchestrator

## Total Code Reduction

| Phase | Files | LOC Removed |
|-------|-------|-------------|
| Phase 1 | 11 files | 7,100 |
| Phase 2 | 1 file | 2,425 |
| **Total** | **12 files** | **~9,525 LOC** |

## Files That Must NOT Be Removed

| File | Reason |
|------|--------|
| `scripts/lib/claude_runner.py` | Used by orchestrator (not TUI-specific) |
| `scripts/api-server.js` | Dashboard backend |
| `scripts/plan_orchestrator.py` | Core execution engine |
| `scripts/lib/status_monitor.py` | Used by orchestrator |
| `scripts/lib/orchestrator_registry.py` | Multi-orchestrator management |
| `scripts/lib/orchestrator_ipc.py` | Inter-process communication |
| `scripts/lib/event_bus.py` | Event system (used by API) |

## Verification Checklist Before Removal

- [ ] Confirm dashboard does not import from `scripts/tui/`
- [ ] Confirm API server does not import from `scripts/tui/`
- [ ] Test orchestrator with `--no-tui --api-server` mode
- [ ] Verify WebSocket events replace TUI activity display
- [ ] Update any documentation referencing TUI
- [ ] Remove TUI-related tests if they exist
