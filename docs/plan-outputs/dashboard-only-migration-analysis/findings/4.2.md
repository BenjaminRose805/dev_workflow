# Task 4.2: dev_workflow Components Only Used by CLI/TUI

## Overview

This document identifies dev_workflow components that are exclusively used by the CLI and TUI interfaces, with no dashboard dependency. These components could potentially be removed in a dashboard-only migration.

## CLI-Only Components

### 1. Plan Skills (Claude Code Commands)

All 17 plan skills are CLI-only - the dashboard cannot invoke them.

| Component | File | Purpose | Dashboard Uses? |
|-----------|------|---------|-----------------|
| `/plan:create` | `create.md` | Create plan from template | **NO** |
| `/plan:implement` | `implement.md` | Execute specific tasks | **NO** |
| `/plan:batch` | `batch.md` | Batch task execution | **NO** |
| `/plan:verify` | `verify.md` | Verify task completion | **NO** |
| `/plan:explain` | `explain.md` | Explain task details | **NO** |
| `/plan:split` | `split.md` | Split task into subtasks | **NO** |
| `/plan:set` | `set.md` | Switch active plan | **NO** |
| `/plan:status` | `status.md` | Show plan status | **NO** |
| `/plan:orchestrate` | `orchestrate.md` | Autonomous execution | **NO** |
| `/plan:templates` | `templates.md` | List templates | **NO** |
| `/plan:archive` | `archive.md` | Archive completed plans | **NO** |
| `/plan:complete` | `complete.md` | Finalize plan | **NO** |
| `/plan:cleanup` | `cleanup.md` | Clean old plans | **NO** |
| `/plan:abandon` | `abandon.md` | Abandon plan | **NO** |
| `/plan:rollback` | `rollback.md` | Rollback changes | **NO** |
| `/plan:migrate` | `migrate.md` | Migrate format | **NO** |
| `/plan:worktree` | `worktree.md` | Manage worktrees | **NO** |

**Location:** `.claude/commands/plan/`
**Approximate LOC:** ~3,000 (markdown files with embedded logic)

### 2. TUI Modules

All TUI components are exclusive to the terminal interface.

| Component | File | Purpose | Dashboard Uses? |
|-----------|------|---------|-----------------|
| Keyboard Handler | `tui/keyboard.py` | Terminal input | **NO** |
| Panels | `tui/panels.py` | Display panels | **NO** |
| Command Palette | `tui/command_palette.py` | Command discovery | **NO** |
| Task Picker | `tui/task_picker.py` | Task selection | **NO** |
| Task Actions | `tui/task_actions.py` | e/i/v/s/f/d keys | **NO** |
| Command Runner | `tui/command_runner.py` | Command execution | **NO** |
| Overlays | `tui/overlays.py` | Modal overlays | **NO** |
| Findings Browser | `tui/findings_browser.py` | Browse findings | **NO** |
| Error Handler | `tui/error_handler.py` | Error recovery | **NO** |
| Config | `tui/config.py` | TUI configuration | **NO** |
| Init | `tui/__init__.py` | Package exports | **NO** |

**Location:** `scripts/tui/`
**Approximate LOC:** ~7,000

### 3. CLI Utility Scripts

Node.js scripts used only from command line.

| Component | File | Purpose | Dashboard Uses? |
|-----------|------|---------|-----------------|
| Status CLI | `status-cli.js` | Status management | **NO** (API server uses library directly) |
| Worktree CLI | `worktree-cli.js` | Worktree management | **NO** (API server uses library directly) |
| Scan Plans | `scan-plans.js` | Generate plan JSON | **NO** (API has own implementation) |
| Parse Structure | `parse-plan-structure.js` | Parse plan markdown | **NO** |
| Substitute Variables | `substitute-variables.js` | Template variables | **NO** |
| Validate Format | `validate-plan-format.js` | Validate plan | **NO** |
| Migrate Completed | `migrate-completed-plan.js` | Migrate plans | **NO** |
| Cache Clear | `cache-clear.js` | Clear caches | **NO** |
| Cache Stats | `cache-stats.js` | Show cache stats | **NO** |
| Check File Status | `check-file-status.js` | File tracking | **NO** |

**Location:** `scripts/`
**Approximate LOC:** ~3,000

### 4. Python CLI Scripts

Python scripts for CLI operations.

| Component | File | Purpose | Dashboard Uses? |
|-----------|------|---------|-----------------|
| Switch Plan | `switch_plan.py` | Plan switching | **NO** |
| Multi-Plan Monitor | `multi_plan_monitor.py` | Aggregate monitoring | **NO** |
| Run API Server | `run_api_server.py` | Server runner | **NO** (could use, but doesn't) |
| Generate API Types | `generate_api_types.py` | Type generation | **NO** |

**Location:** `scripts/`
**Approximate LOC:** ~2,000

Note: `plan_orchestrator.py` is NOT included here because the dashboard DOES use it (via API).

### 5. Shared Command Components

Components used only by CLI plan skills.

| Component | File | Purpose | Dashboard Uses? |
|-----------|------|---------|-----------------|
| Status Tracking | `_common/status-tracking.md` | Status utilities | **NO** (skills only) |
| Git Utilities | `_common/git-utilities.md` | Git operations | **NO** (skills only) |
| Uncommitted Protection | `_common/uncommitted-changes-protection.md` | Safety checks | **NO** |

**Location:** `.claude/commands/plan/_common/`
**Approximate LOC:** ~1,000

### 6. Templates

Plan templates used only by CLI.

| Component | Location | Purpose | Dashboard Uses? |
|-----------|----------|---------|-----------------|
| Template Files | `.claude/templates/plans/` | Plan templates | **NO** |
| Question Templates | `.claude/templates/questions/` | UI templates | **NO** |
| Shared Templates | `.claude/templates/shared/` | Shared components | **NO** |

**Approximate Files:** ~20 template files

### 7. Test Scripts

Testing infrastructure.

| Component | Location | Purpose | Dashboard Uses? |
|-----------|----------|---------|-----------------|
| Test Status CLI | `scripts/tests/test-status-cli.js` | Status tests | **NO** |
| Test Parallel Updates | `scripts/tests/test-parallel-updates.js` | Parallel tests | **NO** |
| Test Recovery | `scripts/tests/test-recovery.js` | Recovery tests | **NO** |
| Test Wrapper | `scripts/test_wrapper.py` | Test utilities | **NO** |

**Location:** `scripts/tests/`
**Approximate LOC:** ~1,000

## Summary: CLI/TUI-Only Components

| Category | Files | ~LOC | Removable? |
|----------|-------|------|------------|
| **Plan Skills** | 20 | 3,000 | Yes, but loses plan authoring |
| **TUI Modules** | 11 | 7,000 | Yes, fully replaceable |
| **CLI Utility Scripts** | 10 | 3,000 | Mostly, some have useful logic |
| **Python CLI Scripts** | 4 | 2,000 | Yes, except orchestrator |
| **Shared Commands** | 3 | 1,000 | Yes, used only by skills |
| **Templates** | 20 | N/A | Yes, but loses template system |
| **Test Scripts** | 4 | 1,000 | Yes, testing infrastructure |
| **TOTAL** | ~72 | ~17,000 | |

## Dependency Analysis

### Components with No Dashboard Dependencies

These can be removed without affecting dashboard:

```
scripts/tui/           (entire directory)
scripts/status-cli.js  (CLI wrapper, not the library)
scripts/worktree-cli.js (CLI wrapper, not the library)
scripts/switch_plan.py
scripts/multi_plan_monitor.py
scripts/scan-plans.js
scripts/parse-plan-structure.js
scripts/substitute-variables.js
scripts/validate-plan-format.js
scripts/migrate-completed-plan.js
scripts/cache-clear.js
scripts/cache-stats.js
scripts/check-file-status.js
scripts/generate_api_types.py
scripts/run_api_server.py (server can run directly)
scripts/tests/         (entire directory)
.claude/commands/plan/ (all skills except orchestrate)
.claude/templates/     (entire directory)
```

### Components Dashboard Needs to Keep

```
scripts/api-server.js           (entry point)
scripts/lib/plan-status.js      (status management)
scripts/lib/worktree-utils.js   (worktree operations)
scripts/plan_orchestrator.py    (execution)
scripts/lib/claude_runner.py    (if used by orchestrator)
```

## Implications for Removal

### If TUI is Removed:

**Impact:** None on dashboard functionality
**Savings:** ~7,000 LOC
**Lost Features:**
- Terminal-based monitoring
- Keyboard-first workflow
- Local development convenience

### If CLI Scripts are Removed:

**Impact:** None on dashboard functionality (API has own implementations)
**Savings:** ~5,000 LOC
**Lost Features:**
- Command-line access to status
- Manual worktree management
- Debugging utilities

### If Plan Skills are Removed:

**Impact:** None on dashboard functionality
**Savings:** ~4,000 LOC
**Lost Features:**
- Plan creation from templates
- Direct task implementation
- Task explanation/verification
- Git auto-commit
- Branch management
- Plan lifecycle operations

## Recommendation

For a "dashboard-only" migration:

1. **Keep:** API server + its library dependencies
2. **Keep:** Plan orchestrator
3. **Remove:** All TUI components
4. **Remove:** Most CLI wrapper scripts
5. **Keep (Optional):** Plan skills if users still use Claude Code for authoring
6. **Evaluate:** Template system - may want to expose via dashboard

**Estimated Removable Code:** ~17,000 LOC (72 files)
**Code That Must Remain:** ~11,500 LOC (4 core files + plan files)
