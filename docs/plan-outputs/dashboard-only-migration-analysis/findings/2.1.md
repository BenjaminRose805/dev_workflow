# Task 2.1: CLI Commands Catalog in dev_workflow

## Overview

The dev_workflow project provides multiple command interfaces:
1. **Plan Skills** (Claude Code slash commands via `.claude/commands/plan/`)
2. **Node.js CLI Scripts** (`scripts/*.js`)
3. **Python CLI Scripts** (`scripts/*.py`)
4. **TUI Components** (`scripts/tui/`)

## Plan Skills (Claude Code Commands)

These are slash commands available within Claude Code sessions.

| Command | File | Purpose |
|---------|------|---------|
| `/plan:status` | status.md | Show plan progress summary |
| `/plan:implement` | implement.md | Execute one or more tasks |
| `/plan:orchestrate` | orchestrate.md | Autonomous plan execution |
| `/plan:batch` | batch.md | Batch execute multiple tasks |
| `/plan:verify` | verify.md | Verify task completion |
| `/plan:set` | set.md | Switch to a different plan |
| `/plan:create` | create.md | Create plan from template |
| `/plan:templates` | templates.md | List available templates |
| `/plan:split` | split.md | Split task into subtasks |
| `/plan:explain` | explain.md | Explain plan task details |
| `/plan:archive` | archive.md | Archive completed plans |
| `/plan:complete` | complete.md | Complete and merge plan |
| `/plan:cleanup` | cleanup.md | Clean up old plans/branches |
| `/plan:abandon` | abandon.md | Abandon a plan |
| `/plan:rollback` | rollback.md | Rollback plan changes |
| `/plan:migrate` | migrate.md | Migrate to output-separated format |
| `/plan:worktree` | worktree.md | Manage git worktrees |

### Shared Components

| File | Purpose |
|------|---------|
| `_common/status-tracking.md` | Status management functions |
| `_common/git-utilities.md` | Git workflow utilities |
| `_common/uncommitted-changes-protection.md` | Safety checks |

## Node.js CLI Scripts

### status-cli.js (Primary CLI)

```bash
node scripts/status-cli.js <command> [options]
```

| Command | Purpose |
|---------|---------|
| `init` | Initialize status.json for plan |
| `status` | Get current plan status (JSON) |
| `mark-started <id>` | Mark task as in_progress |
| `mark-complete <id>` | Mark task as completed |
| `mark-failed <id>` | Mark task as failed |
| `mark-skipped <id>` | Mark task as skipped |
| `write-findings <id>` | Write task findings |
| `read-findings <id>` | Read task findings |
| `start-run` | Start new execution run |
| `complete-run <runId>` | Complete execution run |
| `next [count]` | Get next recommended tasks |
| `phases` | List phases with status |
| `check <id>` | Check if task can start |
| `progress` | Show progress bar |
| `all-plans` | Aggregate status across plans |
| `validate` | Validate status.json |
| `sync-check` | Compare markdown vs status |
| `retryable` | Get retryable failed tasks |
| `exhausted` | Get tasks with no retries |
| `increment-retry <id>` | Increment retry count |
| `detect-stuck` | Find stuck tasks |
| `deps` | Show dependency graph |
| `estimate` | Estimate completion time |
| `conflicts` | Show merge conflicts |
| `merge-order` | Recommended merge order |
| `rebase-check` | Check if rebase needed |
| `worktree-conflict` | Analyze worktree conflicts |
| `resources` | Show resource status |
| `stale-worktrees` | Find stale worktrees |
| `cleanup-worktrees` | Clean abandoned worktrees |
| `check-limits` | Check resource limits |
| `worktree-context` | Current worktree info |

### worktree-cli.js

```bash
node scripts/worktree-cli.js <command> [options]
```

| Command | Options | Purpose |
|---------|---------|---------|
| `create <plan>` | `--attach`, `--auto-attach`, `--force`, `--no-init` | Create worktree for plan |
| `list` | `--json` | List active worktrees |
| `remove <plan>` | `--force` | Remove worktree |
| `context` | | Show current worktree |

### Other Node.js Scripts

| Script | Purpose |
|--------|---------|
| `scan-plans.js` | Scan all plans, generate JSON summary |
| `api-server.js` | REST/WebSocket API server for dashboard |
| `cache-clear.js` | Clear file caches |
| `cache-stats.js` | Show cache statistics |
| `check-file-status.js` | Check file tracking status |
| `migrate-completed-plan.js` | Migrate finished plans |
| `parse-plan-structure.js` | Parse plan markdown |
| `substitute-variables.js` | Template variable substitution |
| `validate-plan-format.js` | Validate plan format |

## Python CLI Scripts

### plan_orchestrator.py (Main Orchestrator)

```bash
python3 scripts/plan_orchestrator.py [options]
```

| Option | Purpose |
|--------|---------|
| `--plan <path>` | Specify plan file |
| `--worktree <path>` | Specify worktree directory |
| `--max-iterations N` | Max Claude invocations (default: 50) |
| `--timeout N` | Session timeout in seconds (default: 600) |
| `--batch-size N` | Tasks per iteration (default: 5) |
| `--dry-run` | Preview without executing |
| `--verbose` | Enable verbose logging |
| `--continue` | Continue without confirmation |
| `--no-tui` | Disable Rich TUI |
| `--no-auto-complete` | Don't auto-merge on completion |
| `--daemon` | Run in background |
| `--list` | List orchestrator instances |
| `--stop <id>` | Stop specific instance |
| `--shutdown-all` | Stop all instances |
| `--status <id>` | Get instance status |
| `--force` | Force shutdown |
| `--api-server` | Enable API server |
| `--api-port N` | API server port (default: 8000) |
| `--api-only` | Monitor mode only |

### switch_plan.py

```bash
python3 scripts/switch_plan.py [command]
```

| Command | Purpose |
|---------|---------|
| (none) | Interactive mode |
| `list` | List all plans |
| `current` | Show current plan |
| `next` | Switch to next incomplete plan |
| `<plan-name>` | Switch to specific plan |

### multi_plan_monitor.py

```bash
python3 scripts/multi_plan_monitor.py [options]
```

| Option | Purpose |
|--------|---------|
| `--layout {focus,split}` | Layout mode |
| `--refresh N` | Refresh rate in Hz (default: 4) |
| `--no-registry` | Don't scan registry |
| `--plan <path>` | Add plan to monitor (repeatable) |

### orchestrator_server.py

HTTP/WebSocket server for orchestrator API. Typically started via plan_orchestrator.py with `--api-server`.

### run_api_server.py

Standalone API server runner.

### generate_api_types.py

Generate TypeScript types from Python API models.

## TUI Components

Located in `scripts/tui/`, provides Rich-based terminal UI.

| Module | Components | Purpose |
|--------|------------|---------|
| `keyboard.py` | `KeyboardHandler`, `KeyEvent`, `InputMode` | Non-blocking keyboard input |
| `overlays.py` | `HelpOverlay`, `OverlayManager` | Modal overlays |
| `panels.py` | `PhaseProgressPanel` | Phase progress display |
| `command_palette.py` | `CommandPaletteModal`, `PlanCommand` | Command discovery |
| `task_picker.py` | `TaskPickerModal` | Interactive task selection |
| `task_actions.py` | `TaskActionHandler` | Task operations |
| `command_runner.py` | `CommandRunner`, `CommandOutputStreamer` | Command execution |
| `findings_browser.py` | | Browse task findings |
| `error_handler.py` | | Error handling utilities |
| `config.py` | | TUI configuration |

## Command Comparison: CLI vs Dashboard

| Feature | CLI/TUI | Dashboard |
|---------|---------|-----------|
| View plan status | ✓ `/plan:status` | ✓ Plans page |
| Execute tasks | ✓ `/plan:implement` | ✗ Not available |
| Start orchestrator | ✓ `plan_orchestrator.py` | ✓ Start dialog |
| Pause/Resume | ✓ Interactive TUI | ✓ Control buttons |
| Stop orchestrator | ✓ `--stop` flag | ✓ Stop button |
| View activity | ✓ TUI panels | ✓ Activity page |
| View findings | ✓ TUI browser | ✓ Findings tab |
| Create plan | ✓ `/plan:create` | ✗ Not available |
| Edit plan | ✓ Direct editing | ✗ Not available |
| Git operations | ✓ Auto-commit/branch | ✗ Not available |
| Worktree management | ✓ `/plan:worktree` | ✗ Not available |
| Template management | ✓ `/plan:templates` | ✗ Not available |
| Dependency graph | ✓ `deps` command | ✓ Visual graph |
| Batch execution | ✓ `/plan:batch` | ✗ Not available |
| Plan verification | ✓ `/plan:verify` | ✗ Not available |
| Plan cleanup | ✓ `/plan:cleanup` | ✗ Not available |
| Multi-plan monitor | ✓ `multi_plan_monitor.py` | ✓ Dashboard home |

## CLI-Only Features (Not in Dashboard)

1. **Plan Creation** - `/plan:create` with templates
2. **Task Implementation** - `/plan:implement` direct execution
3. **Batch Execution** - `/plan:batch` multiple tasks
4. **Plan Verification** - `/plan:verify` completion checks
5. **Git Integration** - Automatic commits, branch management
6. **Worktree Management** - Parallel plan execution
7. **Template System** - `/plan:templates`, `/plan:create`
8. **Plan Splitting** - `/plan:split` subtasks
9. **Rollback** - `/plan:rollback` undo changes
10. **Archive/Cleanup** - `/plan:archive`, `/plan:cleanup`

## Summary Statistics

| Category | Count |
|----------|-------|
| Plan Skills | 17 commands |
| status-cli.js commands | 30+ commands |
| worktree-cli.js commands | 4 commands |
| Node.js utility scripts | 9 scripts |
| Python CLI scripts | 5 scripts |
| TUI modules | 10 modules |
| **Total CLI capabilities** | **75+** |
