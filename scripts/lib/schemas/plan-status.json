{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Plan Status Schema",
  "description": "Schema for tracking plan execution status and outputs",
  "type": "object",
  "required": ["planPath", "planName", "createdAt", "tasks"],
  "properties": {
    "planPath": {
      "type": "string",
      "description": "Relative path to the plan file from project root",
      "minLength": 1
    },
    "planName": {
      "type": "string",
      "description": "Human-readable name of the plan",
      "minLength": 1
    },
    "createdAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when status tracking was initialized"
    },
    "lastUpdatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last status update"
    },
    "currentPhase": {
      "type": "string",
      "description": "Current phase being executed"
    },
    "tasks": {
      "type": "array",
      "description": "List of all tasks in the plan with their status",
      "items": {
        "type": "object",
        "required": ["id", "description", "status"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Task identifier (e.g., '0.1', '1.2')",
            "minLength": 1
          },
          "phase": {
            "type": "string",
            "description": "Phase this task belongs to"
          },
          "description": {
            "type": "string",
            "description": "Task description from the plan",
            "minLength": 1
          },
          "status": {
            "type": "string",
            "enum": ["pending", "in_progress", "completed", "failed", "skipped"],
            "description": "Current status of the task"
          },
          "startedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When task execution started"
          },
          "completedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When task execution completed"
          },
          "duration": {
            "type": "number",
            "description": "Execution duration in milliseconds"
          },
          "findingsPath": {
            "type": "string",
            "description": "Relative path to task findings file"
          },
          "error": {
            "type": "string",
            "description": "Error message if task failed"
          }
        }
      }
    },
    "runs": {
      "type": "array",
      "description": "Execution run history",
      "items": {
        "type": "object",
        "required": ["runId", "startedAt"],
        "properties": {
          "runId": {
            "type": "string",
            "description": "Unique identifier for this run"
          },
          "startedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When this run started"
          },
          "completedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When this run completed"
          },
          "tasksCompleted": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of tasks completed in this run"
          },
          "tasksFailed": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of tasks that failed in this run"
          }
        }
      }
    },
    "summary": {
      "type": "object",
      "description": "Overall progress summary",
      "properties": {
        "totalTasks": {
          "type": "integer",
          "minimum": 0
        },
        "completed": {
          "type": "integer",
          "minimum": 0
        },
        "pending": {
          "type": "integer",
          "minimum": 0
        },
        "failed": {
          "type": "integer",
          "minimum": 0
        },
        "skipped": {
          "type": "integer",
          "minimum": 0
        }
      }
    }
  }
}
